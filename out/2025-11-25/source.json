{
  "source": "stackoverflow",
  "feed": "https://stackoverflow.com/feeds/tag?tagnames=ssl&sort=newest",
  "domain": "stackoverflow.com",
  "title": "Move HTTP request with cert file from nodeJs to .NET not working",
  "url": "https://stackoverflow.com/questions/79828238/move-http-request-with-cert-file-from-nodejs-to-net-not-working",
  "created": "2025-11-24 11:23:09+00:00",
  "text": "<p>I try to move a request with certificate from an old system made with NodeJS to a new system using .NET 8.0.</p>\n<p>Running the .NET code, however, I always get the following error:</p>\n<blockquote>\n<p>The SSL connection could not be established</p>\n</blockquote>\n<p>Here is my NodeJS code:</p>\n<pre class=\"lang-js prettyprint-override\"><code>const Q = require('q');\nreturn Q.Promise((resolve, reject) =&gt; {\n    const options = {\n      method: 'POST',\n      url: ConfigPayment.kmobile.url + '/targetUrl',\n      headers: {\n        'cache-control': 'no-cache',\n        'content-type': 'text/xml;charset=UTF-8',\n        'SoapAction': '',\n      },\n      agentOptions: {\n        ca: [\n          fs.readFileSync('file1.pem'),\n          fs.readFileSync('file2.pem'),\n          fs.readFileSync('file3.crt'),\n          fs.readFileSync('file4.crt'),\n          fs.readFileSync('file5.crt'),\n          fs.readFileSync('file6.crt')\n        ]\n      },\n      strictSSL: true,\n      body: xml\n    }\n</code></pre>\n<p>This is my new .NET 8.0 code:</p>\n<pre class=\"lang-cs prettyprint-override\"><code>var _trustedCertificates = new X509Certificate2Collection();\n\nvar filePathList = new string[]\n{\n    Path.Combine(this.ProjectRootPath, &quot;file1.pem&quot;),\n    Path.Combine(this.ProjectRootPath, &quot;file2.pem&quot;),\n    Path.Combine(this.ProjectRootPath, &quot;file3.crt&quot;),\n    Path.Combine(this.ProjectRootPath, &quot;file4.crt&quot;),\n    Path.Combine(this.ProjectRootPath, &quot;file5.crt&quot;),\n    Path.Combine(this.ProjectRootPath, &quot;file6.crt&quot;)\n};\n\nforeach (var path in filePathList)\n{\n    if (File.Exists(path))\n    {\n        logger.LogDebug($&quot;Files exists {path}&quot;);\n        var cert = new X509Certificate2(path);\n        _trustedCertificates.Add(cert);\n    }\n}\n\nvar handler = new HttpClientHandler()\n{\n    SslProtocols = SslProtocols.Tls12,\n    ServerCertificateCustomValidationCallback = (msg, cert, chain, errors) =&gt;\n    {\n        logger.LogDebug(&quot;ServerCertifica",
  "id": "349497c918b65c920685f5d29b86845d7c2a0d89"
}